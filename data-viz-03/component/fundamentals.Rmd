---
title: "Line graphs, Fundamentals"
author: "Steve Simon"
date: "Created: 2019-08-19"
output: powerpoint_presentation
---

```{r child="../../common-files/src/component-header.Rmd"}
```

```{r}
load("../../common-files/data/cpi.RData")
load("../../common-files/data/houses.RData")
```

### Fundamentals, how to produce a line graph
+The key step in Python
```
mark_line()
```
+ The key step in R
```
geom_line()
```
+ The key step in Tableau
  + Choose Line from the Marks pulldown list
  
<div class="notes">

The basic steps to producing a line graph are fairly easy in each of the systems. In Tableau, you use the mark_line function. In R, you use the geom_line function. In Tableau, if you are lucky, the default graph choice will be a line graph. If not, select Line from the Marks list.

</div>

### Fundamentals, Changing axis range
+ Python
```
alt.Y(scale=alt.Scale(zero=False))
```
or
```
alt.Y(scale=alt.Scale(domain=(100, 200)))
```
+ R code
```
expand_limits(y=0)
```
or
```
ylim(100, 200)
```
+ Tableau steps
  + Double click on axis
 
<div class="notes">

This example is the first one where you can see a big difference between the default options. Python wants to include zero on the y-axis, no matter what. It may make sense for a barchart to always include zero, but it is less obvious for a line graph.

</div>

### Fundamentals, Aesthetics for lines
+ Location
+ Size
+ Shape (not what you think it is!)
+ Color

<div class="notes">

A line could mean a straight line or a curved line, a single line segment, a connected series of line segments or a polygon. It's a pretty complex thing, but generally a line represents a two dimensional relationship.

You can vary the size, shape, and color of a line. Shape is not what you think it is.

</div>

### Fundamentals, Location
+ Sequence of x,y pairs
  + sorted by x
  + Connected in order


((Show a curved line, a straight line, a line segment, a series of line segments, and a polygon. Show the code to create these.))

### Fundamentals, Size

```{r line-size}
initiate_image()
ggplot(cpi, aes(x=t, y=CPI)) +
  geom_line(size=8)
finalize_image()
```

`r display_image`

<div class="notes">

Lines can change size, but some systems refer to this as line width rather than size.

</div>

### Fundamentals, Shape

```{r line-shape}
initiate_image()
ggplot(cpi, aes(x=t, y=CPI)) +
  geom_line(linetype="dotted")
finalize_image()
```

`r display_image`

<div class="notes">

The shape of a line is not whether it is curved or straight. The shape of a line is whether it is represented using solid, dashed, or dotted lines. Most visualizations call this a line type rather than a line shape.

</div>

```{r child="../component/change-defaults.Rmd"}
```

### Fundamentals, Adding lines to a scatterplot

+ Lines can emphasize patterns in a scatterplot
  + Connect means
  + Linear regression (not covered)
  + Moving average (not covered)
  + Smoothing splines (not covered)

<div class="notes">

If you have a lot of data, a line can sometimes emphasize patterns or trends that you might miss with just a scatterplot.

You can do this by connecting lines between individual point means, a linear regression trend line, moving averages, or smoothing splines.

We will only cover the first approach connecting means. The other approaches are quite good and definitely worth talking about. Unfortunately, these alternative approaches are implemented inconsistently across the different programs.

</div>

### Fundamentals, Review an earlier scatterplot

```{r old-friend}
initiate_image()
ggplot(saratoga_houses, aes(x=Bedrooms, y=Price)) +
  geom_point()
finalize_image()
```

`r display_image`

<div class="notes">

Here's the housing data set that we looked at earlier. This scatterplot shows the relationship between number of bedrooms and price.

</div>

### Fundamentals, Lines at individual averages, Python
+ Here's the Python code
```{python}
import pandas as pd
import altair as alt
df = pd.read_csv("../../common-files/data/houses.csv")
```

```{python, echo=TRUE}
pts = alt.Chart(df).mark_point().encode(
    x='Bedrooms',
    y='Price'
)
avg = alt.Chart(df).mark_line().encode(
    x='Bedrooms',
    y='mean(Price)'
)
ch = pts + avg
```

```{python}
ch.save("../images/python/average-summary.html")
```

### Python graph

![Python graph with average summary line](../images/python/average-summary.png)

### Fundamentals, Lines at individual averages, R
+ Here's the code in R
```
ggplot(saratoga_houses, aes(Bedrooms, Price)) +
  geom_point() +
  stat_summary(fun.y=mean, geom="line")
```

<div class="notes">

Here is the R code. You need the stat_summary function to create averages for y at each discrete value of X.

</div>

### R output

```{r average-with-data}
initiate_image()
ggplot(saratoga_houses, aes(Bedrooms, Price)) +
  geom_point() +
  stat_summary(fun.y=mean, geom="line")
finalize_image()
```

`r display_image`

<div class="notes">

There is a clear and consistnet trend in the average price. As the number of bedrooms increase, the average price increases.

</div>

### Fundamentals, Lines at individual averages, Tableau steps
+ Draw your normal scatterplot
+ Drag Price to opposite Y axis
  + Change to Measure(Average)
+ Change Marks for first plot to Shape
+ Right click on either Y axis
  + Select Synchronize Axis

### Fundamentals, Lines at individual averages, Tableau plot

![Tableau plot with lines at individual averages](../images/tableau/individual-averages.png)

```{r child="../component/connect-averages.Rmd"}
```

### Families of lines

(Add three or four slides plus an exercise)

